<html>
  <head>
     <!-- Framework CSS -->
    <link rel="stylesheet" href="public/style/blueprint/screen.css" type="text/css" media="screen, projection">
    <!--[if lt IE 8]><link rel="stylesheet" href="style/blueprint/ie.css" type="text/css" media="screen, projection"><![endif]-->

    <!-- <link rel="stylesheet" href="public/style/main.css" type="text/css" media="screen, projection"> -->
    <link rel="stylesheet" href="public/style/main.css" type="text/css" media="screen, projection">

    <style>
    .selected{
      background: green;
      width: 30px;
      height: 30px;
    }

     #board {
      float: left;
      margin-right: 20px;
    }

    #board td{
      border: 1px solid #000;
      margin: 0;
      min-width: 50px;
      width: 50px;
      height: 60px;
      min-height: 60px;
    }

    table p {
      margin: 0;
      border: 1px solid #ccc;
      color: #fff;
    }

    .path {
      background-color: #fcc;
    }

    .door {
      background-color: #cca;
    }

    #toggleDebug {
      color: #eee;
    }

    #board td.nDoor{
      border-top: 5px solid brown;
    }
    #board td.eDoor{
      border-right: 5px solid brown;
    }
    #board td.wDoor{
      border-left : 5px solid brown;
    }
    #board td.sDoor {
      border-bottom:5px solid brown;
    }

    .gun {
      background-image: url('public/images/gun.png');
      background-repeat: no-repeat;
      background-position: center;
      background-size: 40px 40px;
      border: 2px solid #000;

    }

    #board .highlight {
      background-color: #cfc;
    }

    

    #moveInput button {
      width: 50px;
      height: 50px;
    }

    #moveInput .buttonSpacer {
      min-width: 170px;
      min-height: 30px;
    }

    button {
      float: none;
    }

    .you h4{
      font-weight: bold;
      margin-top: -17px;
      margin-bottom: 0;
    }

    .you {
      border: 2px solid #000;
    }

    .characterDisplay {
    }

    </style>

    <script src="js/libs/jquery-2.1.4.min.js"></script>
    <script src="js/libs/handlebars-v4.0.5.js"></script>
    <script src="js/libs/Queue.js"></script>
    <script src="js/libs/p5.min.js"></script>

    <script src="js/libs/dog.js"></script>
    <script src="js/map.js"></script>
    <script src="js/game.js"></script>
    <script src="js/util.js"></script>
    <script src="js/character.js"></script>
    <script src="js/player.js"></script>
    <script src="js/instructionPlayer.js"></script>
    <script src="js/app.js"></script>
    <script src="js/blueprint.js"></script>

    <script type="text/html" id="404">
      <h1>404 not implemented</h1>
    </script>

    <script type="text/html" id="start">
      <h1>Start the game</h1>
      <p>How many players this game?</p>
      <p>
        {{#each playerCountOptions}}
          <button class="pickNumPlayers {{#if this.selected}}selected{{/if}}" value="{{this.n}}">{{this.n}}</button>
        {{/each}}
      </p>
      <button class="startGame">Start</button>
    </script>
     <script type="text/html" id="setupMap">
      <h3>Facility Blueprints</h3>
      <p>Setup your board to match the layout shown here.</p>
      <button class="next">Continue</button>
     </script>

    <script type="text/html" id="setupCharacters">
      <table>
      <tr class="tableHeader"><td>Character or Object</td><td>Location</td></tr>
      {{#each instructions}}
        <tr><td>{{this.gameObject}}</td><td>{{this.instruction}}</td></li>
      {{/each}}
      </table>

      <button class="next">Continue</button>
    </script>
    <script type="text/html" id="pass">
     <p class='passButton'>
      <img src='public/images/top-secret.png' /><br />
      <em class='red'>Warning <b>Player {{ nextPlayerNum }}</b> only</em>
      <br /><button class="red next" >Ready</button></p>
    </script>

    <script type="text/html" id="player">
    <div id="conversations" class="span-14 section">
      <div class='span-12'>
              <h2>Your Identity</h2>
              <div class='candidateImage span-2' style="background-image: url('/public/images/{{ you.color }}.png')">
              
              </div>
              <p>{{formatCharacter you}}</p>
          </div>
      {{#unless firstRound}}

        <h3>Conversations</h3>
        <table>
        <tr class='tableHeader'><td>Source</td> <td>Statement</td></tr>
        {{#each receivedItems}}
        <tr>
        <td>{{formatCharacter this.from}}</td>
        <td>
        {{#if this.from.dead}}
        <em>Rifling this corpse reveals a set of plans!</em>
        {{else}}
        "I have the plans. Take them and escape to the exit!"
        {{/if}}
        </td>
        </tr>
        {{/each}}

        {{#each newKnowledge}}
        <tr>{{ this}}</tr>
        {{/each}}
  
        {{#unless somethingLearned}}
        <td><em>none</em></td><td><em>none</em></td>
        {{/unless}}
        </table>
      {{/unless}}
    </div>
        <div id="candidates" class="span-16 section">
          <h3>Suspects</h3>
          <div style='margin-bottom: 20px'>
        
          {{#each knowledge}}
            <div class='candidateContainer'>
              <div class='candidateImage span-2' style="background-image: url('/public/images/{{ character.color }}.png');" >
                {{#if noPlans}}
                  <img class='marked' src='/public/images/x.png' />
                {{/if}}
                {{#if hasPlans}}
                  <img class='marked' src='/public/images/circle.png' />
                {{/if}}
              </div>
              <p>{{formatCharacter character}}</p>
          </div>
          {{/each}}
          </div>

        </div>
        <div id="actions" class="span-13 section">
        <div class="span-6">
          {{#if hasGun}}
          <div id="shoot">
           <img src="/public/images/gun.png" style="width:100px;height:100px" >
            <select class="targetColor" name="targetColor">
              {{#each shootingTargets}}
              <option value={{color}}>{{displayName}}</option>
              {{/each}}
            </select>
            <button class="submitMove" x-move="shoot">shoot</button>
            <p>or
            <button class="submitMove" x-move="drop">Drop Gun</button>
            </p>
          </div>
          

          {{else}}
            <div id="moveInput">
            {{#each moveInputs}}
              {{#everyX @index 3}}
                <br />
              {{/everyX}}
              {{#if legal}}
                <button class="submitMove" x-move="{{dir}}">{{dir}}</button>
              {{else}}
                <button disabled>{{dir}}</button> 
              {{/if}}
              
            {{/each}}
            </div>
          {{/if}}
          </div>
          
          <div id="plans" class="span-4">
            
            {{#if hasPlans}}
              <img src='/public/images/briefcase.png' style="width:100px; height:100px" />

            {{else}}
              <img src='/public/images/no_briefcase.png' style="width:100px; height:100px" />
            {{/if}}
            </div>
          </div>
          <div id="poison" class="span-4">
            {{#if canPoison}}
              <img src="/public/images/poison.jpg" style="width:100px;height:100px;" />
              {{#any poisonTargets}}
              <select class="targetColor" name="targetColor">
                {{#each poisonTargets}}
                <option value={{color}}>{{formatCharacter this}}</option>
                {{/each}}
              </select>
                <button class="submitMove" x-move="poison">Poison</button>

              {{else}}
                <p><em>No one here to poison.</em></p> 
              {{/any}}
            {{else}}
              <img class='marked' src='/public/images/x.png' style="width:100px; height:100px" />
            {{/if}}
          </div>  
        </div>
    </script>
    <script type="text/html" id="move">
      <h3>Move Instructions</h3>
        <button id="playButton" class="playInstructions">Play</button>
        <ul id="moveInstructions">
        {{#each instructions}}
          <li>{{ this }}</li>
        {{/each}}
      </ul>
      <h2>Victims</h2>
      {{#if anyVictims}}
        <ul>
        {{#each victims}}
          <li>{{ this }}</li>
        {{/each}}
        </ul>
      {{ else }}
        <p><em>None this turn.</em></p>
      {{/if}}

      <button class="next">Continue</button>
    </script>

    <script type="text/x-handlebars" id="gameOver">
    <h3>Game Over</h3>
    {{#if oneWinner }}
      <h4>{{formatCharacter result.winner}} is the winner!</h4>
      <p>{{result.message}}</p>
    {{else}}
      <h4>{{result.message}}</h4>

    {{/if}}
  </script>

    <script type="text/html" id="debug">
    <a class="toggle" href="#">toggle debug</a>
    <div id="debugViewInner" style="display:none">
      {{debug-view}}
    </div>
    </script>

  </head>
  <body>
    <div id="blueprint" style="display:none"></div>
    <div id="view"></div>
    <div id="debugView"></div>
  </body>
</html>
