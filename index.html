<html>
  <head>

     <!-- Framework CSS -->
    <link rel="stylesheet" href="public/style/blueprint/screen.css" type="text/css" media="screen, projection">
    <!--[if lt IE 8]><link rel="stylesheet" href="style/blueprint/ie.css" type="text/css" media="screen, projection"><![endif]-->

    <link rel="stylesheet" href="public/style/main.css" type="text/css" media="screen, projection">

    <style>
    #board {
      float: left;
      margin-right: 20px;
    }

    #board td{
      border: 1px solid #000;
      margin: 0;
      min-width: 75;
      width: 75;
      height: 75;
      min-height: 75;
    }

    table p {
      margin: 0;
      border: 1px solid #ccc;
      color: #fff;
    }

    .path {
      background-color: #fcc;
    }

    .door {
      background-color: #cca;
    }

    #board td.nDoor{
      border-top: 5px solid white;
    }
    #board td.eDoor{
      border-right: 5px solid white;
    }
    #board td.wDoor{
      border-left : 5px solid white;
    }
    #board td.sDoor {
      border-bottom:5px solid white;
    }

        .gun {
      background-image: url('public/gun.jpg');
      background-repeat: no-repeat;
      background-position: center;
      border: 2px solid #000;
    }
    /*

    .squareDescription{
      color: #aaa;
    }

    #players {
      float: left;
    }

    

    .highlight {
      background-color: #cfc;
    }

    

    #moveInput button {
      width: 200px;
      height: 30px;
    }

    #moveInput .buttonSpacer {
      min-width: 200px;
      min-height: 30px;
    }



    #checklist td{
      width: 50px;
      height: 50px;
      border: 2px solid;
      text-align: center;
      font-size: 40;
      font-family: sans-serif;
      padding-top: 7;
    }

    #checklist td.newKnowledge {
      border: 2px dotted red;
    }

    #checklist td.newKnowledgeRed {
      border: 2px dotted yellow;
    }

    .characterDisplay {
      font-weight: bold;
    }

    .blackKnowledge{
      color: white;
    }

    .redCharacter {
      color: red;
    }
    .blueCharacter {
      color: blue;
    }
    .greenCharacter {
      color: green;
    }
    .yellowCharacter {
      color: yellow;
      -webkit-text-stroke: 1px gray;
    }
    .blackCharacter {
      color: black;
    }
    .whiteCharacter {
      -webkit-text-stroke: 1px gray;
      color: white;
    }
    .orangeCharacter {
      color: orange;
    }
    .pinkCharacter {
      color: pink;
    }
    .grayCharacter {
      color: gray;
    }
    .brownCharacter {
      color: brown;
    }
*/

    </style>



    <script type="text/x-handlebars">
      <div class="container">
        <div id='header' class="span-15 pull-2">
          <img src="public/images/logo_fingers.png" id="logo" />
          <div id='imageText'>
            <p class='slogan'>get in. get out. dont blow your cover.</p>
            <h1>SNEAK</h1>
            <button>Done</button>
            <p class="slogan">Turn-01-dialog-reveal</p>
          </div>
        </div>

        {{outlet}}
        
        <div class="span-13 section">
          <br style="clear:both" />
          {{#view "debug" isVisibleBinding="debugIsVisible"}}
            <!-- <button {{action 'refreshDebug'}}>refresh< /button> --> <!-- temporary hack until game   is   an ember model -->
            {{debug-view}}
          {{/view}}
    
          <p><em><a href="#" {{action "toggleDebug"}}>Toggle  debug view</a></em></p>
          <div id="blueprint"></div>

        </div>
      </div>
    </script>
  
    <script type="text/x-handlebars" id ="index">
       <label>Play game on-screen?</label> {{view Ember.Checkbox checkedBinding="model.onScreen"}}

      <p>{{#link-to 'setup'}}Start game{{/link-to}}</p>
    </script>
  
    <script type="text/x-handlebars" id="setup">
      <h3>Setup</h3>

      {{# if onScreen}}
      {{ else }}
      <p>Exit is: {{format-square exit}}</p>
      
      <ul>
      {{#each item in instructions}}
        <li>{{item.instruction}}</li>
      {{/each}}
      </ul>

      {{/if}}

      <p><b>Character rank</b> <em>breaks ties for picking up objects. If multiple characters arrive at the same object at the same time, the character with the higher rank will get to pick up the object.</em></p>
      <p><b>Rank in ascending order</b>: <em>{{rank-list}}</em></p>
      <p>{{#link-to 'characterAssignment'}}Find out your characters{{/link-to}}</p>
    

    </script>
    
    <script type="text/x-handlebars" id="characterAssignment">
      <h3>Player character assignments</h3>
      {{#if PassManager.isPassing}}
        {{partial 'pass'}}
      {{else}}
        <p>You are {{current-player-rank-color}}.</p>
        <p><button {{action 'next'}}>Got it</button></p>
      {{/if}}
    </script>
    
    <script type="text/x-handlebars" id="poison">
    <h3>Select someone to poison</h3>
    {{#if PassManager.isPassing}}
        {{partial 'pass'}}
    {{else}}
      (You are {{ current-player-rank-color }})
      {{#if canPoison }}
        {{#if noTargets}}
          <p>No one to poison here. <button {{action "next"}}>Continue</button></p>
        {{ else }}

          <form {{action "poison" on="submit"}}>
            {{view "select" contentBinding="targets" valueBinding='targetColor'}}
            <button type="submit">Poison</button>
          </form>
          or
          <button {{action "next"}}>Skip</button>
        {{/if}}
      {{else}}
        <p>You already used your poison. <button {{action "next"}}>Continue</button></p>
      {{/if}}
    {{/if}}

    </script>

    <script type="text/x-handlebars" id="moves">
      <h3>Input moves</h3>
      {{#if PassManager.isPassing}}
        {{partial 'pass'}}
      {{else}}
        <p>You are {{current-player-rank-color}}.</p>
        <div id="moveInput">
        <p>
          {{#if shoot}}
            <button {{action "submitMove" "shoot" }}>shoot gun</button>
            <button {{action "submitMove" "drop" }}>drop gun</button>
          {{else }}
            {{#if onScreen}}
              <p>
                {{#if nw}}
                  <button {{action "submitMove" "nw" }}>nw</button>
                {{else}}
                  <button disabled>nw</button> 
                {{/if}}
                
                {{#if n}}
                <button {{action "submitMove" "n" }}>n</button>
                {{else}}
                  <button disabled>n</button> 
                {{/if}}
      
                {{#if ne}}
                <button {{action "submitMove" "ne" }}>ne</button>
                {{else}}
                  <button disabled>ne</button> 
                {{/if}}
              </p>

              <p>        
                {{#if w}}
                  <button {{action "submitMove" "w" }}>w</button>
                {{else}}
                  <button disabled>w</button> 
                {{/if}}
    
                <button {{action "submitMove" "hold" }}>hold</button>
                
                {{#if e}}
                  <button {{action "submitMove" "e" }}>e</button>
                {{else}}
                  <button disabled>e</button> 
                {{/if}}
              </p>
              <p>        
                {{#if sw}}
                  <button {{action "submitMove" "sw" }}>sw</button>
                {{else}}
                  <button disabled>sw</button> 
                {{/if}}
      
                {{#if s}}
                  <button {{action "submitMove" "s" }}>s</button>
                {{else}}
                  <button disabled>s</button> 
                {{/if}}
      
                {{#if se}}
                 <button {{action "submitMove" "se" }}>se</button>
                {{else}}
                  <button disabled>se</button> 
                {{/if}}
              </p>
            {{ else }}

              {{#if position-top}} <!-- south is up, west is right -->
                <p>        
                  {{#if se}}
                   <button {{action "submitMove" "se" }}>se</button>
                  {{else}}
                    <button disabled>se</button> 
                  {{/if}}
        
                  {{#if s}}
                    <button {{action "submitMove" "s" }}>s</button>
                  {{else}}
                    <button disabled>s</button> 
                  {{/if}}
        
                  {{#if sw}}
                    <button {{action "submitMove" "sw" }}>sw</button>
                  {{else}}
                    <button disabled>sw</button> 
                  {{/if}}
                </p>
                <p>        
      
                  {{#if e}}
                    <button {{action "submitMove" "e" }}>e</button>
                  {{else}}
                    <button disabled>e</button> 
                  {{/if}}
  
                  <button {{action "submitMove" "hold" }}>hold</button>
                  
                  {{#if w}}
                    <button {{action "submitMove" "w" }}>w</button>
                  {{else}}
                    <button disabled>w</button> 
                  {{/if}}
                </p>
                <p>
                  {{#if ne}}
                  <button {{action "submitMove" "ne" }}>ne</button>
                  {{else}}
                    <button disabled>ne</button> 
                  {{/if}}
                  
                  {{#if n}}
                  <button {{action "submitMove" "n" }}>n</button>
                  {{else}}
                    <button disabled>n</button> 
                  {{/if}}
  
                  {{#if nw}}
                    <button {{action "submitMove" "nw" }}>nw</button>
                  {{else}}
                    <button disabled>nw</button> 
                  {{/if}}
                </p>
              
              {{else}}
                <p>
                  {{#if nw}}
                    <button {{action "submitMove" "nw" }}>nw</button>
                  {{else}}
                    <button disabled>nw</button> 
                  {{/if}}
                  
                  {{#if n}}
                  <button {{action "submitMove" "n" }}>n</button>
                  {{else}}
                    <button disabled>n</button> 
                  {{/if}}
        
                  {{#if ne}}
                  <button {{action "submitMove" "ne" }}>ne</button>
                  {{else}}
                    <button disabled>ne</button> 
                  {{/if}}
                </p>
  
                <p>        
                  {{#if w}}
                    <button {{action "submitMove" "w" }}>w</button>
                  {{else}}
                    <button disabled>w</button> 
                  {{/if}}
      
                  <button {{action "submitMove" "hold" }}>hold</button>
                  
                  {{#if e}}
                    <button {{action "submitMove" "e" }}>e</button>
                  {{else}}
                    <button disabled>e</button> 
                  {{/if}}
                </p>
                <p>        
                  {{#if sw}}
                    <button {{action "submitMove" "sw" }}>sw</button>
                  {{else}}
                    <button disabled>sw</button> 
                  {{/if}}
        
                  {{#if s}}
                    <button {{action "submitMove" "s" }}>s</button>
                  {{else}}
                    <button disabled>s</button> 
                  {{/if}}
        
                  {{#if se}}
                   <button {{action "submitMove" "se" }}>se</button>
                  {{else}}
                    <button disabled>se</button> 
                  {{/if}}
                </p>
              {{/if}} <!-- /position-top/bottom  -->
            {{/if}} <!-- /onScreen -->
          {{/if}}

        </div>
        {{/if}}
    </script>

    <script type="text/x-handlebars" id="shoot">
      <h3>Pick Target</h3>
      <p>You are {{current-player-color}} ({{current-player-name}}).</p>
      <form {{action "fire" on="submit"}}>
        {{view "select" content=targets valueBinding='targetColor'}}
        <button type="submit">Shoot</button>
      </form>
    </script>
    
    <script type="text/x-handlebars" id="moveInstructions">
      {{#if onScreen}}
      {{ else }}
        <h3>Move Instructions</h3>
        <ul>
        {{#each instruction in instructions}}
          <li>{{ instruction }}</li>
        {{/each}}
      </ul>
      {{/if}}
      <h2>Victims</h2>
      <ul>
      {{#each deathDescription in victims}}
        <li>{{ deathDescription }}</li>
      {{/each}}
      </ul>
      {{#if onScreen}}
        <button {{action "confirm"}}>Next</button>
      {{ else }}
      <button {{action "confirm"}}>Done moving</button>
      {{/if}}

    </script>

    <script type="text/x-handlebars" id="_pass">
      <p>Pass the screen to {{ current-player-public }}</p>
      <p><button {{action 'next'}}>Done</button></p>
    </script>

    <script type="text/x-handlebars" id="dialogs">
      <h3>Dialogs ({{length}})</h3>
      <ul> 
        {{#each item in controller}}
        <li>
          {{item.summary}}
        </li>
        {{/each}}
      </ul>
      <p>{{#link-to 'dialogReveals'}}Reveal dialog results{{/link-to}}</p>
    </script>
  
     <script type="text/x-handlebars" id="dialogReveals">
      {{#if PassManager.isPassing}}
        {{partial 'pass'}}
      {{else}}
        <div id="conversations" class="span-13 section">
          <h3>Conversations</h3>
          {{ current-player-conversations }}
        </div>
        <div id="candidates" class="span-13 section">
          <h3>Suspects</h3>
          {{ current-player-knowledge }}

        </div>
        <div id="inventory" class="span-13 section">
          <h3>Inventory</h3>
          {{current-player-inventory}}

        </div>
        <p><button {{action 'next'}}>Got it</button></p>
      {{/if}}
    </script>

    <script type="text/x-handlebars" id="victory">
    <h3>Game Over</h3>
    {{#if oneWinner }}
      <h4>{{result.winner.color}} is the winner!</h4>
      <p>{{result.message}}</p>
    {{else}}
      <h4>{{result.message}}</h4>

    {{/if}}
  </script>

    <script src="js/libs/jquery-1.10.2.js"></script>
    <script src="js/libs/handlebars-v2.0.0.js"></script>
    <script src="js/libs/ember-1.9.1.js"></script>
    <script src="js/libs/ember-data.js"></script>
    <script src="js/libs/localstorage_adapter.js"></script>
    <script src="js/libs/ember-states.js"></script>
    <script src="js/libs/Queue.js"></script>
    <script src="js/libs/p5.min.js"></script>

    <script src="js/map.js"></script>
    <script src="js/game.js"></script>
    <script src="js/util.js"></script>
    <script src="js/character.js"></script>
    <script src="js/player.js"></script>

    <script src="js/app.js"></script>
                      <script src="js/blueprint.js"></script>

  </head>
  <body>
  </body>
</html>